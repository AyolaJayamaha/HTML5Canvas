<!DOCTYPE html>
<html>

<head>

<title>Mathematical ToolBox </title>
    <meta charset="utf-8" />
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="./css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="./css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="./js/jquery-2.1.4.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <style>
        img{

            opacity: 0.4;

        }

    </style>
	
</head>

<body onload="init()">
    <div class="container marketing">
        <div class="row">
            <div class="row">
                
            </div>
            <div class="col-lg-9">
                <canvas id="canvas" width="800" height="500" style="border:1px solid #d3d3d3;" ></canvas>
            </div> 
            <div class="col-lg-1">
            <img class="img-circle" id="ir" src="ruler.png" alt="ruler"  width="50" height="50" onclick="showRuler()">
                <h4>Ruler</h4>
            </div>
            
            <div class="col-lg-1">
                <img class="img-circle" id="ic" src="compass.png" alt="Generic placeholder image"  width="50" height="50" onclick ="showCompass()">
                <h4>Compass</h4>
            </div>
           
            <div class="col-lg-1">
                <img class="img-circle"   id="il" src="label.png" alt="Generic placeholder image" width="50" height="50" onclick ="showLabel()">
                <h4 align="right">Label</h4>

            </div>

            <div class="col-lg-3">
                <!--Ruler-->
                <div id="ruler">
                    <h2>Ruler</h2>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon1">X1</span>
                        <input type="number" class="form-control" name="x1value" id="x1" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon2">Y1</span>
                        <input type="number" class="form-control" name="y1value" id="y1" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon3">Extend</span>
                        <input type="number" class="form-control" name="extend1" id="e1" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon4">X2</span>
                        <input type="number" class="form-control" name="x2value" id="x2" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon5">Y2</span>
                        <input type="number" class="form-control" name="y2value" id="y2" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon6">Extend</span>
                        <input type="number" class="form-control" name="extend2" id="e2" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon7">Color</span>
                        <input type="color" class="form-control" name="color" id="clr">
                    </div>
                    <input type="button" class="btn btn-default" onclick="ruler()" value="Draw Line">
                    
                    <input type="button" class="btn btn-default" id="pickA" value="Pick A (X1,Y1)">
                    <input type="button" class="btn btn-default" id="pickB" value="Pick B (X2,Y2)">
                    
                </div>
                <!--END Ruler -->
                
                <!--compass-->
                <div id="compass">
                <h2>Compass</h2>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cx">X</span>
                    <input type="number" class="form-control" name="xvalue" id="x" placeholder="cm">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cy">Y</span>
                    <input type="number" class="form-control" name="yvalue" id="y" placeholder="cm">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cr">Radius</span>
                    <input type="number" class="form-control" name="r" id="radius" placeholder="cm">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cs">Start Angle</span>
                    <input type="number" class="form-control" name="a1" id="sa" placeholder="degree">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="ce">End Angle</span>
                    <input type="number" class="form-control" name="a2" id="ea" placeholder="degree">
                </div>
              
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="angle">
                        <label class="radio-inline"><input type="radio" name="optradio" id="rotation1" >Counterclockwise</label>     
                        <label class="radio-inline"><input type="radio" name="optradio" id ="rotation2" >Clockwise</label>
                    </span>
                </div>
      
      
                <div class="input-group input-group-sm">
                <span class="input-group-addon" id="colorpick">Color</span>


               <input type="color" class="form-control" name="color" id="clc">
               </div>
                <div>
                <input type="button" class="btn btn-default" onclick="compass()" value="Draw Arc">
                
                <input type="button" class="btn btn-default" id="pickC" value="Pick Center">
                </div>  

                </div>              
                <!--END compass -->
                
                
                <!--Label-->
                <div id="label">
                                <h2>Label</h2>

                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="lx">X</span>
                    <input type="number" class="form-control" name="xvalue" id="xx" placeholder="cm">
                </div>


                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="ly">Y</span>
                    <input type="number" class="form-control" name="yvalue" id="yy" placeholder="cm">
                </div>


                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="lt">Text</span>
                    <input type="text" name="text" class="form-control" id="txt">
                </div>
                <input type="button" class="btn btn-default" onclick="label()" value="Label Item">
                
                <input type="button" class="btn btn-default"  value="Locate (X,Y)" id="pickL">
                </div>              
                <!--END Label -->
            </div>
           
        </div>

        
    </div>

    <script>
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
		var selectedItem='';		
		
        canvas.addEventListener('mousemove', function(evt) {
            var mousePos = getMousePos(canvas, evt);
            var message = 'Mouse position: ' + mousePos.x/50 + ',' + mousePos.y/50;
            writeMessage(canvas, message);
        }, false);
		
		canvas.addEventListener('mousedown', function(evt) {
            var mousePos = getMousePos(canvas, evt);
            
			switch(selectedItem)
			{
			
			case 'a' :
			setA(evt);
			break;
			
			case 'b' :
			setB(evt);
			break;
			
			case 'c' :
			setC(evt);
			break;
			
			case 'l' :
			setL(evt);
			break;
			
			}
			
			
        }, false);
		
		$('#pickL').click(function() {
		selectedItem = 'l';
		
		});
		
		$('#pickA').click(function() {
		selectedItem = 'a';
	
		});
		
		$('#pickB').click(function() {

		selectedItem = 'b';});
		
		$('#pickC').click(function() {
		selectedItem = 'c'; 
		
		});
		
		function setL(evt) 
		{
            var mousePos = getMousePos(canvas, evt);
			
			$('#xx').val(mousePos.x/50);
			$('#yy').val(mousePos.y/50);
		
		}
		
		function setA(evt) 
		{
            var mousePos = getMousePos(canvas, evt);
			
			$('#x1').val(mousePos.x/50);
			$('#y1').val(mousePos.y/50);
		
		}
		
		function setB(evt) 
		{
            var mousePos = getMousePos(canvas, evt);
			
			$('#x2').val(mousePos.x/50);
			$('#y2').val(mousePos.y/50);
		
		}
		
		function setC(evt) 
		{
            var mousePos = getMousePos(canvas, evt);
			
			$('#x').val(mousePos.x/50);
			$('#y').val(mousePos.y/50);
		
		}
		
        //padding around grid
    
        function init() 
		{
            
            var p = 0;
            //size of canvas
            var bw = 800,
                bh = 500;
            var cw = bw + (p * 2) + 1;
            var ch = bh + (p * 2) + 1;
            
            context.beginPath();
            for (var x = 0; x <= bw; x += 50) {
                context.moveTo(0.5 + x + p, p);
                context.lineTo(0.5 + x + p, bh + p);
            }


            for (var x = 0; x <= bh; x += 50) {
                context.moveTo(p, 0.5 + x + p);
                context.lineTo(bw + p, 0.5 + x + p);
            }

            context.strokeStyle = "blue";
            context.stroke();
			
			$("#ruler").hide();
			$("#compass").hide();
			$("#label").hide();
        }


        function compass() {
            
                //arc(center coordinates,radius,start angle,end angle,anticlockwise)
                var x = document.getElementById('x').value*50;
                var y = document.getElementById('y').value*50;
                var radius = document.getElementById('radius').value*50;
                var startAngle = document.getElementById('sa').value;
                var endAngle = document.getElementById('ea').value;
                var counterClockwise = false;
                if (document.getElementById('rotation1').checked) 
				{
                    var counterClockwise = document.getElementById('rotation1').value;
                }
                var clc = document.getElementById('clc').value;
                context.beginPath();
                startAngle = startAngle * Math.PI/180;
                endAngle = endAngle * Math.PI/180;
				context.strokeStyle = clc;
                context.arc(x, y, radius, startAngle, endAngle, counterClockwise);
                context.stroke();
            
        }

        function ruler() {
          
                var x1 = document.getElementById('x1').value*50;
                var y1 = document.getElementById('y1').value*50;
                var x2 = document.getElementById('x2').value*50;
                var y2 = document.getElementById('y2').value*50;
				var e1 = document.getElementById('e1').value*50;
				var e2 = document.getElementById('e2').value*50;
				
                var rcolor = document.getElementById('clr').value;
                context.strokeStyle = rcolor;
				if(e1>0)
				{
				var m0 = (y1-y2)/(x1-x2);
				
				var x0 = x1 - (e1 / Math.sqrt(m0 * m0 + 1));
		
					//line parallel to y axis
					if(x1==x2)
					{
						y0=y1-e1;
					
					}
					else
					{
						var test = (y1-y2)/(x1-x2)*(x0-x1);
						if(test<0)
							var y0 = y1 - Math.abs(test);
						else
							var y0 = y1 + Math.abs(test);
					}
				
				x1=x0;
				y1=y0;
				
				}
				
				if(e2>0)
				{
				var m1 = (y1-y2)/(x1-x2);
				var x3 = x2+(e2/Math.sqrt(m1*m1+1));
				
					//line parallel to y axis
					if(x1==x2)
					{
						y0=y1-e1;
				
					}
					else
					{
					var ext = m1*(x3-x2);
					
					if(ext>0)
					var y3 = y2 + Math.abs(ext);
					else
					var y3 = y2 - Math.abs(ext);
					
					}
				
				x2=x3;
				y2=y3;
				
				}
				context.beginPath();
                context.moveTo(x1, y1);
                context.lineTo(x2, y2);
                context.stroke();
            
        }

        function label() {
            
            
                var context = canvas.getContext("2d");
                var x = document.getElementById('xx').value*50;
                var y = document.getElementById('yy').value*50;
                var text = document.getElementById('txt').value;
                context.font = "11px Arial";
                context.fillText(text, x, y);
            
        }

        function writeMessage(canvas, message) {
            
            context.clearRect(canvas.width - 198, 0, canvas.width, canvas.height - 451);
            context.font = '12pt Calibri';
            context.fillStyle = 'black';
            context.fillText(message, canvas.width - 190, 25);
        }

        function getMousePos(canvas, evt) {
            var rect = canvas.getBoundingClientRect();
            return {
                x: evt.clientX - rect.left,
                y: evt.clientY - rect.top
            };
        }
		
		function showRuler(	)
		{
			$("#ruler").show();
            $("#ir").css("opacity","1");
            $("#compass").hide();
            $("#ic").css("opacity","0.4");
			$("#label").hide();
            $("#il").css("opacity","0.4");
	
		}
		
		function showCompass()
		{
			$("#compass").show();
            $("#ic").css("opacity","1");
            $("#ruler").hide();
            $("#ir").css("opacity","0.4");
            $("#label").hide();
            $("#il").css("opacity","0.4");

		}
		
		function showLabel()
		{
			$('#label').show();
            $('#il').css("opacity","1");
            $('#ruler').hide();
            $('#ir').css("opacity","0.4");
            $('#compass').hide();
            $('#ic').css("opacity","0.4");

		}
	
    </script>

</body>

</html>