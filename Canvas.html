<!DOCTYPE html>
<html>

<head>

<title>Mathematical ToolBox</title>
    <meta charset="utf-8" />
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="./css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="./css/bootstrap-theme.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="./js/jquery-2.1.4.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <style type="text/css">
      #container2 { position: relative; }
      #canvas2 { border: 1px solid #000; }
    </style> 
    <style>
        img{

            opacity: 0.4;

        }
        img#ic2{

            opacity: 1;
        }

        img#is2{

            opacity: 1;
        }
        
        img#il2{

            opacity: 1;
        }
        

    </style>
    <script type="text/javascript" src="./js/boxes2.js"></script>
 
	

    <script>
    
    function allowDrop(ev) {
        ev.preventDefault();
    }

    function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
    }

    function drop(ev) 
    {
        ev.preventDefault();
       var data = ev.dataTransfer.getData("text");
       ev.target.appendChild(document.getElementById(data));
    
       
    }
    </script>

</head>

<body onload="init()">

<br> 
  <div class="container marketing">

    <input type="button" class="btn btn-default" onclick="showPanel1()" value="Geomatrical Constructions">
    <input type="button" class="btn btn-default" onclick="showPanel2()" value="Standard Shapes">

  <br><br>
        <div id="toolbox">
            <div class="panel panel-success">
              <div class="panel-heading">
                <h3 class="panel-title">Geometrical Drawings</h3>
              </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-lg-9" style="position:relative; width:850px; height:500px ">
                        <canvas id="layer1" style="z-index: 1; position:absolute; left:0px;top:0px; border:1px solid #d3d3d3;" height="500" width="800 "></canvas>
                    </div> 
                    <div class="col-lg-1">
                    <img class="img-circle" id="ir" src="./image/ruler.png" alt="ruler"  width="50" height="50" onclick="showRuler()">
                        <h4>Ruler</h4>
                    </div>
            
            <div class="col-lg-1">
                <img class="img-circle" id="ic" src="./image/compass.png" alt="Generic placeholder image"  width="50" height="50" onclick ="showCompass()">
                <h4>Compass</h4>
            </div>
           
            <div class="col-lg-1">
                <img class="img-circle"   id="il" src="./image/label.png" alt="Generic placeholder image" width="50" height="50" onclick ="showLabel()">
                <h4>Label</h4>

            </div>

            <div class="col-lg-3">
                <!--Ruler-->
                <div id="ruler">
                    <h2>Ruler</h2>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon1">X1</span>
                        <input type="number" class="form-control" name="x1value" id="x1" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon2">Y1</span>
                        <input type="number" class="form-control" name="y1value" id="y1" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon3">Extend</span>
                        <input type="number" class="form-control" name="extend1" id="e1" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon4">X2</span>
                        <input type="number" class="form-control" name="x2value" id="x2" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon5">Y2</span>
                        <input type="number" class="form-control" name="y2value" id="y2" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon6">Extend</span>
                        <input type="number" class="form-control" name="extend2" id="e2" placeholder="cm">
                    </div>
                    <div class="input-group input-group-sm">
                        <span class="input-group-addon" id="sizing-addon7">Color</span>
                        <input type="color" class="form-control" name="color" id="clr">
                    </div>
                    <input type="button" class="btn btn-default" onclick="ruler()" value="Draw Line">
                    
                    <input type="button" class="btn btn-default" id="pickA" value="Pick A (X1,Y1)">
                    <input type="button" class="btn btn-default" id="pickB" value="Pick B (X2,Y2)">
                    
                </div>
                <!--END Ruler -->
                
                <!--compass-->
                <div id="compass">
                <h2>Compass</h2>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cx">X</span>
                    <input type="number" class="form-control" name="xvalue" id="x" placeholder="cm">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cy">Y</span>
                    <input type="number" class="form-control" name="yvalue" id="y" placeholder="cm">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cr">Radius</span>
                    <input type="number" class="form-control" name="r" id="radius" placeholder="cm">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="cs">Start Angle</span>
                    <input type="number" class="form-control" name="a1" id="sa" placeholder="degree">
                </div>
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="ce">End Angle</span>
                    <input type="number" class="form-control" name="a2" id="ea" placeholder="degree">
                </div>
              
                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="angle">
                        <label class="radio-inline"><input type="radio" name="optradio" id="rotation1" checked="true">Counterclockwise</label>     
                        <label class="radio-inline"><input type="radio" name="optradio" id ="rotation2" >Clockwise</label>
                    </span>
                </div>
      
      
                <div class="input-group input-group-sm">
                <span class="input-group-addon" id="colorpick">Color</span>


               <input type="color" class="form-control" name="color" id="clc">
               </div>
                <div>
                <input type="button" class="btn btn-default" onclick="compass()" value="Draw Arc">
                
                <input type="button" class="btn btn-default" id="pickC" value="Pick Center">
                </div>  

                </div>              
                <!--END compass -->
                
                
                <!--Label-->
                <div id="label">
                                <h2>Label</h2>

                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="lx">X</span>
                    <input type="number" class="form-control" name="xvalue" id="xx" placeholder="cm">
                </div>


                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="ly">Y</span>
                    <input type="number" class="form-control" name="yvalue" id="yy" placeholder="cm">
                </div>


                <div class="input-group input-group-sm">
                    <span class="input-group-addon" id="lt">Text</span>
                    <input type="text" name="text" class="form-control" id="txt">
                </div>
                <input type="button" class="btn btn-default" onclick="label()" value="Label Item">
                
                <input type="button" class="btn btn-default"  value="Locate (X,Y)" id="pickL">
                
                </div>   <!--END Label -->  
               
            </div>
           
        </div>  <!-- End Row -->

           
    


      </div>

      </div>  <!-- End toolbox main div -->

    </div>  <!-- End Panel -->
        
        <div id="shape">
        <div class="panel panel-info">
              <div class="panel-heading">
                <h3 class="panel-title">Standard Shapes</h3>
              </div>
      <div class="panel-body">
        <div class="row">
            
            <div class="col-lg-9"   ondragover="allowDrop(event)" ondrop="drop(event)">
                <canvas id="canvas2" width="800" height="500"  style="border:1px solid #d3d3d3;"></canvas>
            </div> 

            <div class="col-lg-1">
            <img class="img-circle" id="ic2" src="./image/circle.png" alt="circle"  width="50" height="50" draggable="true" ondragstart="drag(event)">
                 <input type="button" class="btn btn-default"  value="Circle" id="pickCircle">
                
            </div>
            
            <div class="col-lg-1">
                <img class="img-circle" id="is2" src="./image/square.jpg" alt="square"  width="50" height="50" draggable="true" ondragstart="drag(event)" >
                 <input type="button" class="btn btn-default"  value="Square" id="pickSquare">
                
            </div>
           
            <div class="col-lg-1">
                <img class="img-circle"   id="il2" src="./image/line.png" alt="line" width="50" height="50" draggable="true" >
                <input type="button" class="btn btn-default"  value="Line" id="pickLine">
                

            </div>

         </div>  <!-- End Row -->
      </div>

    </div>

</div>   <!-- End shape main div -->
   

<div id="save">
        <div class="panel panel-warning">
         <div class="panel-heading">
                <h3 class="panel-title">Administration</h3>
              </div>     
 <div class="panel-body">
    <div class="row">
        <div class ="col-lg-12">
            <input type="button" class="btn btn-default" onclick="loaddrawing()" value="Load Drawing API Calls">
        </div>
    </div>
    <br> <br>
        <div class="row">
        <div class ="col-lg-6">
            <textarea id="inputTextToSave" style="width:512px;height:256px"></textarea> </div>
            <div class ="col-lg-2">Filename to Save As:</div>
        <div class ="col-lg-2"><input id="inputFileNameToSaveAs"></input></div>
        <div class ="col-lg-2"><button onclick="saveTextAsFile()">Save Text to File</button></div>
       
    <br><br>
    <div class="row" >
        <div class ="col-lg-6"></div>
        <div class ="col-lg-2">Select a File to Load:</div>
        <div class ="col-lg-2"><input type="file" id="fileToLoad"></div>
        <div class ="col-lg-2"><button onclick="loadFileAsText()">Load Selected File</button><div>
    

    </div>
    

</div>

  
 </div> <!-- End div container marketting -->
</body>

<script type="text/javascript" src="./js/toolbox.js"></script>

<script> 
        var canvas = document.getElementById('layer1');
        var context = canvas.getContext('2d');
        var selectedItem='';   
        
        
        canvas.addEventListener('mousemove', function(evt) {
            var mousePos = getMousePos(canvas, evt);
            var message = '(X,Y): ' + mousePos.x/50 + ',' + mousePos.y/50;
            writeMessage(canvas, message);

            if (selectedItem=='b')
            {
                writeMessage(canvas,"Length :"+ Math.sqrt( (mousePos.x/50-$('#x1').val())*(mousePos.x/50-$('#x1').val())+(mousePos.y/50-$('#y1').val())*(mousePos.y/50-$('#y1').val()) ) );
            }
            else if (selectedItem=='r')
            {
                writeMessage(canvas,"Radius :"+ Math.sqrt( (mousePos.x/50-$('#x').val())*(mousePos.x/50-$('#x').val())+(mousePos.y/50-$('#y').val())*(mousePos.y/50-$('#y').val()) ) );
            }
            else if (selectedItem=='k')
            {
                setAngle(evt);
                writeMessage(canvas,"Angle :" + ( $('#sa').val()- $('#ea').val() ) );
            }
        }, false);
        
        canvas.addEventListener('mousedown', function(evt) {
            var mousePos = getMousePos(canvas, evt);
            
            switch(selectedMethod)
            {
            case 'r':
                switch(selectedItem)
                {
                
                case 'a' :
                setA(evt);
                
                selectedItem='b';
                break;
                
                case 'b' :
                setB(evt);
                ruler();
                selectedItem='a';
                break;
              
                }

                break;

            case 'c':
                 switch(selectedItem)
                {
                    case 'c' :
                     setC(evt);
                     selectedItem ='r';
                    break;

                    case 'r' :
                    setR(evt);
                    selectedItem='k';
                    break;

                    case 'k' :
                    
                    selectedItem ='c';
                    compass();
                    break;

                }

                break;

            case 'l': 
                 switch(selectedItem)
                {  

                    case 'l' :
                    setL(evt);
                    break;
                }

                break;
        }
        }, false);
        
       




function saveTextAsFile()
{
    var textToWrite = document.getElementById("inputTextToSave").value;
    var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'});
    var fileNameToSaveAs = document.getElementById("inputFileNameToSaveAs").value;

    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    if (window.webkitURL != null)
    {
        // Chrome allows the link to be clicked
        // without actually adding it to the DOM.
        downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
    }
    else
    {
        // Firefox requires the link to be added to the DOM
        // before it can be clicked.
        downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
        downloadLink.onclick = destroyClickedElement;
        downloadLink.style.display = "none";
        document.body.appendChild(downloadLink);
    }

    downloadLink.click();
}

function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function loadFileAsText()
{
    var fileToLoad = document.getElementById("fileToLoad").files[0];

    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("inputTextToSave").value = textFromFileLoaded;
    }
    fileReader.readAsText(fileToLoad, "UTF-8");
}

function loaddrawing()
{
    
var string ="";
    
        for (var i = 0; i < rulers.length; i++) 
        {
            string +="ruler";
            string =string.concat(" (id: ", rulers[i].index);
            string = string.concat(" x1: ", rulers[i].xs);
            string =string.concat(" y1: ", rulers[i].ys);
            string =string.concat(" x2: ", rulers[i].xe);
            string =string.concat(" y2: ", rulers[i].ye);
            string =string.concat("), ");
        }

        for (var i = 0; i < compasses.length; i++) 
        {
            string +="compass";
            string =string.concat(" (id: ", compasses[i].index);
            string = string.concat(", x: ", compasses[i].x);
            string =string.concat(", y: ", compasses[i].y);
            string =string.concat(", radius: ", compasses[i].radius);
            string =string.concat(", start angle: ", compasses[i].starta);
            string =string.concat(", end angle: ", compasses[i].enda);
            string =string.concat("), ");
        }

        for (var i = 0; i < labels.length; i++) 
        {
            string +="label";
            string =string.concat(" (id: ", labels[i].index);
            string = string.concat(" x: ", labels[i].xp);
            string =string.concat(" y: ", labels[i].yp);
            string =string.concat(" text: ", labels[i].message);
            string =string.concat("), ");
        }

        document.getElementById("inputTextToSave").innerHTML=string;
}

</script>
</body>
</html>